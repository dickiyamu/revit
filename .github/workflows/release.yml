name: CD

on: 
  push:
    branches: [ master ]

jobs:
  build:
    name: "Build and release the Revit Plugins"
    runs-on: windows-latest

    steps:
      - name: "Checkout Master Branch"
        uses: actions/checkout@v2
        
      - name: Setup MSbuild
        uses: microsoft/setup-msbuild@v1.0.0
        
      - name: Setup Nuget.exe
        uses: nuget/setup-nuget@v1

      - name: Nuget Restore
        run: nuget restore 

      - name: MSBuild Honyebee Core
        working-directory: Honeybeee.Core
        run: |
          msbuild /p:Configuration=Release
          
      - name: MSBuild Revit 2020 
        working-directory: Honeybee.Revit.2020
        run: |
          msbuild /p:Configuration=Release
                    
      - name: Zip Build Artifact
        run: |
          Compress-Archive -U -Path Honeybee.Revit.2020\bin\Release\* -DestinationPath HoneybeeRevitPlugin
     
